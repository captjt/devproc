# DevProc Example Configuration
# This is a sample config demonstrating DevProc's capabilities

name: example-project

# Global environment variables (applied to all services)
env:
  NODE_ENV: development

# Docker Compose file path (optional, defaults to docker-compose.yml)
# compose: docker-compose.yml

# Service groups - organize related services together
groups:
  core:
    - echo
    - counter
  monitoring:
    - logger
    - metrics
  # To use Docker Compose integration
  infrastructure:
    - postgres
    - redis

# Example services for a typical full-stack application
services:
  # Simple echo service for testing
  echo:
    cmd: "bash -c 'while true; do echo Hello from echo service; sleep 2; done'"
    color: cyan

  # Counter service
  counter:
    cmd: "bash -c 'i=0; while true; do echo Count: $i; i=$((i+1)); sleep 1; done'"
    color: green
    depends_on:
      - echo

  # Timestamp logger
  logger:
    cmd: "bash -c 'while true; do date; sleep 3; done'"
    color: yellow

  # Metrics service
  metrics:
    cmd: 'bash -c ''while true; do echo "Memory: $((RANDOM % 100))% CPU: $((RANDOM % 100))%"; sleep 5; done'''
    color: magenta

  # =====================================================
  # Docker Compose Integration Examples
  # Uncomment the services below to use with docker-compose.yml
  # =====================================================

  # PostgreSQL via Docker Compose
  # The 'compose: true' flag tells DevProc to manage this service
  # using 'docker compose up/stop' commands
  postgres:
    compose: true
    # Healthcheck runs inside the container using docker compose exec
    healthcheck:
      cmd: docker compose exec -T postgres pg_isready -U devproc -d devproc_dev
      interval: 2s
      retries: 30

  # Redis via Docker Compose
  redis:
    compose: true
    # Healthcheck runs inside the container using docker compose exec
    healthcheck:
      cmd: docker compose exec -T redis redis-cli ping
      interval: 2s
      retries: 15

  # Example API service that depends on compose services
  # api:
  #   cmd: npm run dev
  #   depends_on:
  #     postgres: healthy
  #     redis: healthy
  #   env:
  #     DATABASE_URL: postgres://devproc:devproc@localhost:5432/devproc_dev
  #     REDIS_URL: redis://localhost:6379
  #   color: green
